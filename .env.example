# ===================================
# DocQA-MS Environment Configuration
# ===================================

# -----------------------
# Database Configuration
# -----------------------
POSTGRES_USER=docqa_admin
POSTGRES_PASSWORD=change_this_secure_password
POSTGRES_DB=docqa_db
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# Database URLs for each service
DOC_INGESTOR_DB_URL=postgresql://docqa_admin:change_this_secure_password@postgres:5432/doc_ingestor
DEID_DB_URL=postgresql://docqa_admin:change_this_secure_password@postgres:5432/deid
INDEXEUR_DB_URL=postgresql://docqa_admin:change_this_secure_password@postgres:5432/indexeur
LLM_QA_DB_URL=postgresql://docqa_admin:change_this_secure_password@postgres:5432/llm_qa
SYNTHESE_DB_URL=postgresql://docqa_admin:change_this_secure_password@postgres:5432/synthese
AUDIT_DB_URL=postgresql://docqa_admin:change_this_secure_password@postgres:5432/audit

# -----------------------
# RabbitMQ Configuration
# -----------------------
RABBITMQ_DEFAULT_USER=docqa_rabbitmq
RABBITMQ_DEFAULT_PASS=change_this_rabbitmq_password
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_MANAGEMENT_PORT=15672

# -----------------------
# Redis Configuration
# -----------------------
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=change_this_redis_password

# -----------------------
# LLM Configuration
# -----------------------
# Primary LLM Provider (ollama, openai, anthropic)
LLM_PROVIDER=ollama

# Ollama Configuration (Local LLM)
OLLAMA_BASE_URL=http://host.docker.internal:11434
OLLAMA_MODEL=mistral
# Alternative models: llama2:13b, llama2:70b, meditron, medllama2
LLM_TEMPERATURE=0.3
LLM_MAX_TOKENS=1024
LLM_CONTEXT_LENGTH=4096
LLM_REQUEST_TIMEOUT=60

# OpenAI Configuration (Fallback or Primary)
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_MODEL=gpt-4-turbo-preview
ENABLE_LLM_FALLBACK=false

# Anthropic Claude Configuration (Optional)
ANTHROPIC_API_KEY=sk-ant-your-key-here
ANTHROPIC_MODEL=claude-3-sonnet-20240229

# Local LLM Configuration (legacy - for LlamaCpp)
LOCAL_LLM_MODEL_PATH=/models/llama-2-70b.gguf
LOCAL_MODEL_NAME=llama2:70b
LOCAL_LLM_DEVICE=cuda  # or cpu
LOCAL_LLM_GPU_LAYERS=35

# -----------------------
# Embedding Models
# -----------------------
# Embedding Provider (sentence-transformers, ollama)
EMBEDDING_PROVIDER=sentence-transformers
EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2
EMBEDDING_DIMENSION=384
EMBEDDING_BATCH_SIZE=32

# Medical-specific embedding models (uncomment to use):
# EMBEDDING_MODEL=dmis-lab/biobert-base-cased-v1.2
# EMBEDDING_DIMENSION=768
# EMBEDDING_MODEL=microsoft/BiomedNLP-PubMedBERT-base-uncased-abstract
# EMBEDDING_DIMENSION=768

# Ollama Embeddings (alternative)
# EMBEDDING_PROVIDER=ollama
# EMBEDDING_MODEL=nomic-embed-text
# EMBEDDING_DIMENSION=768

EMBEDDING_DEVICE=cuda  # or cpu

# -----------------------
# FAISS Configuration
# -----------------------
FAISS_INDEX_TYPE=IndexFlatL2  # or IndexIVFFlat for large datasets
FAISS_INDEX_PATH=/data/faiss_indices
FAISS_USE_GPU=true
EMBEDDING_CACHE_SIZE=1000
MODEL_DOWNLOAD_TIMEOUT=600

# -----------------------
# Security & Authentication
# -----------------------
# JWT Secret (generate with: openssl rand -hex 32)
JWT_SECRET_KEY=your_jwt_secret_key_here_change_this
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24

# Auth0 Configuration (for frontend)
AUTH0_DOMAIN=your-tenant.auth0.com
AUTH0_CLIENT_ID=your_auth0_client_id
AUTH0_CLIENT_SECRET=your_auth0_client_secret
AUTH0_AUDIENCE=https://api.docqa-ms.com

# API Keys for service-to-service communication
API_GATEWAY_KEY=change_this_api_gateway_key

# -----------------------
# Service Ports
# -----------------------
DOC_INGESTOR_PORT=8001
DEID_PORT=8002
INDEXEUR_PORT=8003
LLM_QA_PORT=8004
SYNTHESE_PORT=8005
AUDIT_PORT=8006
API_GATEWAY_PORT=8000
FRONTEND_PORT=3000

# -----------------------
# File Storage
# -----------------------
DOCUMENT_STORAGE_PATH=/data/documents
MAX_UPLOAD_SIZE_MB=100

# -----------------------
# De-identification Configuration
# -----------------------
DEID_STRATEGY=synthesize  # Options: redact, replace, hash, synthesize
DEID_CONFIDENCE_THRESHOLD=0.85
PRESERVE_MEDICAL_ENTITIES=true

# spaCy Model Configuration
SPACY_MODEL=en_core_web_lg  # or en_core_web_trf for transformer-based
SPACY_DISABLE_COMPONENTS=["textcat","lemmatizer"]

# Presidio Configuration
PRESIDIO_ANALYZER_MODEL=en
PRESIDIO_CONFIDENCE_THRESHOLD=0.85

# -----------------------
# Monitoring & Logging
# -----------------------
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
GRAFANA_ADMIN_PASSWORD=change_this_grafana_password
PROMETHEUS_RETENTION_DAYS=15

# Sentry (Error Tracking) - Optional
SENTRY_DSN=https://your-sentry-dsn-here

# -----------------------
# Performance & Scaling
# -----------------------
WORKERS_PER_SERVICE=4
MAX_CONCURRENT_REQUESTS=100
RATE_LIMIT_PER_MINUTE=60

# -----------------------
# Feature Flags
# -----------------------
ENABLE_OCR=true
ENABLE_HL7_PARSING=true
ENABLE_FHIR_PARSING=true
ENABLE_STREAMING_RESPONSES=true
ENABLE_AUDIT_LOGGING=true
ENABLE_METRICS=true

# -----------------------
# Development/Production
# -----------------------
ENVIRONMENT=development  # development, staging, production
DEBUG=true

# -----------------------
# CORS Configuration
# -----------------------
CORS_ORIGINS=http://localhost:3000,https://docqa-ms.com
CORS_ALLOW_CREDENTIALS=true

# -----------------------
# Email Notifications (Optional)
# -----------------------
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-email-password
ADMIN_EMAIL=admin@docqa-ms.com

# -----------------------
# Backup Configuration
# -----------------------
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_PATH=/backups

# -----------------------
# Compliance & Regulatory
# -----------------------
ENABLE_HIPAA_COMPLIANCE=true
ENABLE_GDPR_COMPLIANCE=true
DATA_RETENTION_DAYS=2555  # 7 years for medical records
AUDIT_RETENTION_DAYS=3650  # 10 years for audit logs

# -----------------------
# Medical Specific
# -----------------------
MEDICAL_TERMINOLOGY_SYSTEM=SNOMED-CT  # or ICD-10, LOINC
HL7_VERSION=2.5.1
FHIR_VERSION=R4
